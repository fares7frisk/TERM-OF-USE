console.log("Ø¨Ø¯Ø£ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø®Ø§Ø¯Ù…...");

const express = require('express');
const fs = require('fs');
const app = express();
const port = 3000;

app.use(express.json()); // Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¨ÙŠØ§Ù†Ø§Øª JSON Ù…Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„

// Ø®Ø¯Ù…Ø© Ø§Ù„ØµÙØ­Ø© Ø§Ù„ØªÙŠ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ·
app.get('/', (req, res) => {
    console.log('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©');
    res.sendFile(__dirname + '/index.html'); // ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† index.html Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ù†ÙØ³ Ø§Ù„Ù…Ø¬Ù„Ø¯
});

// Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ù…Ù„Ù Ù†ØµÙŠ Ø¹Ù†Ø¯ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ù…ØªØµÙØ­
app.post('/save-info', (req, res) => {
    console.log('ØªÙ… Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„Ø®Ø§Ø¯Ù…');
    const { userAgent, language, timestamp } = req.body;
    const ip = req.socket.remoteAddress; // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù€ IP

    const logEntry = `
        ------------------------------
        ðŸ“Œ IP: ${ip}
        ðŸŒ Ø§Ù„Ù…ØªØµÙØ­: ${userAgent}
        ðŸ—£ Ø§Ù„Ù„ØºØ©: ${language}
        â³ Ø§Ù„ÙˆÙ‚Øª: ${timestamp}
        ------------------------------
    `;

    fs.appendFile('user_data.txt', logEntry, (err) => {
        if (err) {
            console.error('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', err);
            return res.status(500).json({ message: 'âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª' });
        }
        console.log('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
        res.json({ message: 'âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!' });
    });
});

// Ø¨Ø¯Ø¡ Ø§Ù„Ø³ÙŠØ±ÙØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ÙØ° 3000
app.listen(port, () => {
    console.log(`Ø§Ù„Ø®Ø§Ø¯Ù… ÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰ http://localhost:${port}`);
});
